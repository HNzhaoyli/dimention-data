# dimention-data

confient = nn.Sequential(nn.Conv2d(2,3,1,1,padding=0),#六个线性分类器
                         nn.Softmax(dim=1))
GAP = nn.AdaptiveAvgPool2d((1,1))
x = torch.rand(2,2,2,3)
y = confient(x) # 大小(2,3,2,3)即3张概率图
print(y)
'''
y
tensor([[[[0.1382, 0.1772, 0.1512],
          [0.1825, 0.1767, 0.1621]],

         [[0.4591, 0.5201, 0.4468],
          [0.5411, 0.5224, 0.4711]],

         [[0.4028, 0.3027, 0.4019],
          [0.2764, 0.3009, 0.3668]]],


        [[[0.1841, 0.1257, 0.1461],
          [0.1579, 0.1697, 0.1545]],

         [[0.5185, 0.4178, 0.4334],
          [0.4927, 0.4923, 0.5015]],

         [[0.2975, 0.4564, 0.4205],
          [0.3495, 0.3381, 0.3440]]]], grad_fn=<SoftmaxBackward>)
'''
print('!'*50)
print('y[0]',y[0]) #第一个维度的所有数据，总共两个，第一个包含的数字是 3*2*3维度
'''
y[0] 
tensor([[[0.1382, 0.1772, 0.1512],
         [0.1825, 0.1767, 0.1621]],

        [[0.4591, 0.5201, 0.4468],
         [0.5411, 0.5224, 0.4711]],

        [[0.4028, 0.3027, 0.4019],
         [0.2764, 0.3009, 0.3668]]], grad_fn=<SelectBackward>)
torch.Size([3, 2, 3])
print(y[0].size())#(3 2 3)
'''
print("@"*30)
print(y[:,1,:,:])# 第二个维度的所有数据，每一个batch  三张图片的 第二个图片
'''
tensor([[[0.4591, 0.5201, 0.4468],
         [0.5411, 0.5224, 0.4711]],

        [[0.5185, 0.4178, 0.4334],
         [0.4927, 0.4923, 0.5015]]], grad_fn=<SliceBackward>)
torch.Size([2, 2, 3])
'''

print(y[:,1,:,:].size())


tensor([[[[0.1382, 0.1772, 0.1512],
          [0.1825, 0.1767, 0.1621]],

         [[0.4591, 0.5201, 0.4468],
          [0.5411, 0.5224, 0.4711]],

         [[0.4028, 0.3027, 0.4019],
          [0.2764, 0.3009, 0.3668]]],


        [[[0.1841, 0.1257, 0.1461],
          [0.1579, 0.1697, 0.1545]],

         [[0.5185, 0.4178, 0.4334],
          [0.4927, 0.4923, 0.5015]],

         [[0.2975, 0.4564, 0.4205],
          [0.3495, 0.3381, 0.3440]]]], grad_fn=<SoftmaxBackward>)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
y[0] tensor([[[0.1382, 0.1772, 0.1512],
         [0.1825, 0.1767, 0.1621]],

        [[0.4591, 0.5201, 0.4468],
         [0.5411, 0.5224, 0.4711]],

        [[0.4028, 0.3027, 0.4019],
         [0.2764, 0.3009, 0.3668]]], grad_fn=<SelectBackward>)
torch.Size([3, 2, 3])
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
tensor([[[0.4591, 0.5201, 0.4468],
         [0.5411, 0.5224, 0.4711]],

        [[0.5185, 0.4178, 0.4334],
         [0.4927, 0.4923, 0.5015]]], grad_fn=<SliceBackward>)
torch.Size([2, 2, 3])
